const Web3 = require('web3');
const contractAbi = [
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "_nome",
				"type": "string"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "valor",
				"type": "uint256"
			}
		],
		"name": "depositar",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "nome",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "valor",
				"type": "uint256"
			}
		],
		"name": "sacar",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "saldo",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "verSaldo",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
];

const ganacheHost = 'HTTP://127.0.0.1:7545';
const ganacheAccount = '0x5a3947bd18c55e72999a71ec88bf0c5c4cd7cc2ce214cd921a0f9050b0c03880';
const ganacheGasPrice = '20000000000';
const ganacheGasLimit = '3000000';
const bytecode = '60806040523480156200001157600080fd5b5060405162000c0e38038062000c0e8339818101604052810190620000379190620001eb565b806000908162000048919062000487565b506000600181905550506200056e565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b620000c18262000076565b810181811067ffffffffffffffff82111715620000e357620000e262000087565b5b80604052505050565b6000620000f862000058565b9050620001068282620000b6565b919050565b600067ffffffffffffffff82111562000129576200012862000087565b5b620001348262000076565b9050602081019050919050565b60005b838110156200016157808201518184015260208101905062000144565b60008484015250505050565b6000620001846200017e846200010b565b620000ec565b905082815260208101848484011115620001a357620001a262000071565b5b620001b084828562000141565b509392505050565b600082601f830112620001d057620001cf6200006c565b5b8151620001e28482602086016200016d565b91505092915050565b60006020828403121562000204576200020362000062565b5b600082015167ffffffffffffffff81111562000225576200022462000067565b5b6200023384828501620001b8565b91505092915050565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806200028f57607f821691505b602082108103620002a557620002a462000247565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b6000600883026200030f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82620002d0565b6200031b8683620002d0565b95508019841693508086168417925050509392505050565b6000819050919050565b6000819050919050565b600062000368620003626200035c8462000333565b6200033d565b62000333565b9050919050565b6000819050919050565b620003848362000347565b6200039c62000393826200036f565b848454620002dd565b825550505050565b600090565b620003b3620003a4565b620003c081848462000379565b505050565b5b81811015620003e857620003dc600082620003a9565b600181019050620003c6565b5050565b601f82111562000437576200040181620002ab565b6200040c84620002c0565b810160208510156200041c578190505b620004346200042b85620002c0565b830182620003c5565b50505b505050565b600082821c905092915050565b60006200045c600019846008026200043c565b1980831691505092915050565b600062000477838362000449565b9150826002028217905092915050565b62000492826200023c565b67ffffffffffffffff811115620004ae57620004ad62000087565b5b620004ba825462000276565b620004c7828285620003ec565b600060209050601f831160018114620004ff5760008415620004ea578287015190505b620004f6858262000469565b86555062000566565b601f1984166200050f86620002ab565b60005b82811015620005395784890151825560018201915060208501945060208101905062000512565b8683101562000559578489015162000555601f89168262000449565b8355505b6001600288020188555050505b505050505050565b610690806200057e6000396000f3fe608060405234801561001057600080fd5b50600436106100575760003560e01c80632deb124b1461005c5780632ed245841461007a5780637371b0d614610098578063a41de865146100b4578063d5ca6228146100d2575b600080fd5b6100646100ee565b604051610071919061031f565b60405180910390f35b61008261017c565b60405161008f919061035a565b60405180910390f35b6100b260048036038101906100ad91906103a6565b610186565b005b6100bc61022a565b6040516100c9919061035a565b60405180910390f35b6100ec60048036038101906100e791906103a6565b610230565b005b600080546100fb90610402565b80601f016020809104026020016040519081016040528092919081815260200182805461012790610402565b80156101745780601f1061014957610100808354040283529160200191610174565b820191906000526020600020905b81548152906001019060200180831161015757829003601f168201915b505050505081565b6000600154905090565b600081116101c9576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016101c0906104a5565b60405180910390fd5b60015481111561020e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161020590610511565b60405180910390fd5b80600160008282546102209190610560565b9250508190555050565b60015481565b60008111610273576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161026a90610606565b60405180910390fd5b80600160008282546102859190610626565b9250508190555050565b600081519050919050565b600082825260208201905092915050565b60005b838110156102c95780820151818401526020810190506102ae565b60008484015250505050565b6000601f19601f8301169050919050565b60006102f18261028f565b6102fb818561029a565b935061030b8185602086016102ab565b610314816102d5565b840191505092915050565b6000602082019050818103600083015261033981846102e6565b905092915050565b6000819050919050565b61035481610341565b82525050565b600060208201905061036f600083018461034b565b92915050565b600080fd5b61038381610341565b811461038e57600080fd5b50565b6000813590506103a08161037a565b92915050565b6000602082840312156103bc576103bb610375565b5b60006103ca84828501610391565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061041a57607f821691505b60208210810361042d5761042c6103d3565b5b50919050565b7f4f2076616c6f7220646f207361717565206465766520736572206d61696f722060008201527f717565207a65726f2e0000000000000000000000000000000000000000000000602082015250565b600061048f60298361029a565b915061049a82610433565b604082019050919050565b600060208201905081810360008301526104be81610482565b9050919050565b7f53616c646f20696e737566696369656e74652e00000000000000000000000000600082015250565b60006104fb60138361029a565b9150610506826104c5565b602082019050919050565b6000602082019050818103600083015261052a816104ee565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061056b82610341565b915061057683610341565b925082820390508181111561058e5761058d610531565b5b92915050565b7f4f2076616c6f7220646f206465706f7369746f206465766520736572206d616960008201527f6f7220717565207a65726f2e0000000000000000000000000000000000000000602082015250565b60006105f0602c8361029a565b91506105fb82610594565b604082019050919050565b6000602082019050818103600083015261061f816105e3565b9050919050565b600061063182610341565b915061063c83610341565b925082820190508082111561065457610653610531565b5b9291505056fea2646970667358221220bac285f8639fd4f07c884f26b9b6fdf8f3cee8588c7bccf5f5273ad64f8e602b64736f6c63430008120033'

const nome = 'Solana';

async function deployContract() {
  try {
    const web3 = new Web3(ganacheHost);

    const accounts = await web3.eth.getAccounts();
    const deployer = accounts[0]; 

    const contract = new web3.eth.Contract(contractAbi);

    const gasEstimate = await contract.deploy({
      data: '0x' + bytecode,
      arguments: [nome]
    }).estimateGas();

    const deployedContract = await contract.deploy({
      data: '0x' + bytecode,
      arguments: [nome]
    }).send({
      from: deployer,
      gas: gasEstimate,
      gasPrice: ganacheGasPrice,
      gasLimit: ganacheGasLimit
    });

    console.log('Contrato implantado em:', deployedContract.options.address);
  } catch (error) {
    console.error('Erro durante a implantação do contrato:', error);
  }
}

deployContract();
